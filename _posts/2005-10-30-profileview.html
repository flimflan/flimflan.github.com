---
title: ProfileView
permalink: ProfileView.html
layout: migrated
date: 2005-10-30
dasblog_id: 679db00a-aabe-4e78-a167-5c508685805e
published_at: 2005-10-30 20:27:07.000000000 -06:00
tags: .NET;ProfileView
comments:
- created: 2006-01-09 09:06:00.109375000 -06:00
  author: Bryan Peters
  email: bryan@urbandude.com
  url: http://www.urbandude.com
  content: Has anyone figured out how to retrieve profile data without updating the
    LastActivityDate?  This has been a big headache for me and is keeping me from
    using profiles to store data.
- created: 2006-01-09 21:30:05.343750000 -06:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: ! 'I can think of 2 possible solutions:


    1) Create your own profile provider - you can make it do whatever you want. http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnaspp/html/ASPNETProvMod_Prt5.asp


    2) Modify the stored procedure created by the SqlRoleProvider. It looks like the
    one you want to modify is called aspnet_Profile_GetProperties (in your provider
    database - aspnetdb by default). The last statement in that procedure updates
    the LastActivityDate. Remove it (or comment it out).'
- created: 2006-01-11 07:45:02.234375000 -06:00
  author: Bryan Peters
  email: bryan@urbandude.com
  url: http://http;//www.urbandude.com
  content: Thanks Joshua!  I think modifying the stored procedure is my fix for this.
- created: 2006-03-01 10:38:53.468750000 -06:00
  author: Zoltan
  content: ! 'Hi,


    I''m trying to download the newest release, but the .zip contain an older version:
    1.0.1030.2005


    I realy need the new features :)


    One more thing.

    How can I use this control in an admin page? I want my site admins to be able
    to change the users profile info.'
- created: 2006-03-03 18:35:34.062500000 -06:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: ! 'Zoltan -

    You''ve stumbled upon something strange. When I download the release using Firefox,
    I *also* get the old version. I have checked and re-checked, uploading the new
    version many times, and I still get the old version.  I then tried using IE, and
    it downloaded the correct new version. I have no idea why at this point, but its
    something to try.


    Sorry, you cannot use it in an admin page to manage other user''s profiles. My
    control is built on Microsoft''s Profile Provider framework, and that framework
    wasn''t designed for the use case of manipulating other people''s profiles.'
- created: 2006-10-04 12:01:22.034623300 -05:00
  author: Karl Wilkens
  email: kwilkens@multiweb.com
  url: http://www.multiweb.com
  content: Great job on this! Especially the latest release being able to edit other
    profiles as an admin. Question - assuming the control is just dropped onto a page
    in design time and I want to select users from a separate list box and then update
    it, I currently need to click Reset. I tried but could find no way to reset the
    form other than clicking that button. Any thoughts on how I would accomplsh that?
- created: 2006-12-12 13:25:02.462750000 -06:00
  author: Moussa
  email: kaniene@hotmail.com
  content: ! 'Hi Joshua,

    I am still learning asp.net and I am haour instruction having trouble implementing
    the profileView. Can you give me more detail about how to use it. I followed your
    instruction above but I got the following error message in the control: &quot;error
    creatin control- conent1 unknow server tag ''flim:profileView'' &quot;


    As a learning project, I trying to create a dating website where user will create
    their profile and a profile of their match. So all site visitors will be able
    to search for soulmate base on location, gender, age, sexual orientation, ect....

    What is the best way to implement such a project?

    Thank for your help and caoching!

    Moussa'
- created: 2006-12-14 16:45:49.369000000 -06:00
  author: Jeff
  url: http://www.jeffguthrie.com
  content: Is the built in membership/login controls good for a website with thousands
    of visitors?  Or is using the profile to 'chatty' with the database as I have
    read at other websites?  I like your control by the way.  Thanks for sharing.
- created: 2006-12-14 21:43:16.603375000 -06:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: ! 'Jeff - The membership/login controls are independent of the profile
    controls. You can use one without the other. I do not know if the default providers
    are too chatty for a high traffic website, but the beauty of the provider model
    is that you can optimize the behind-the-scenes database interaction for your use,
    while still using the same UI controls (like the Login, and ProfileView). You
    can fully develop your website using the built-in local SQL Express database providers,
    and then swap them out for highly optimized providers when needed. Your web.config
    will change, but none of the rest of your code should have to.

    There is now a lot of documentation (including full source code of the Microsoft
    providers) on how to create your own provider. Check out Scott Guthrie''s post:

    http://weblogs.asp.net/scottgu/archive/2006/04/13/442772.aspx'
- created: 2007-01-15 00:28:06.269994500 -06:00
  author: briiin
  email: brion_ace@yahoo.co.uk
  content: Hi i like it thanks for taking your time to create it.
- created: 2007-01-29 09:23:16.484375000 -06:00
  author: Fred Pinter
  email: fred@fredpinter.com
  content: ! 'Hi Joshua,


    I have heard great things about ProfileView, but I am new to Visual Studio and
    I''m not sure how to use the source code. Could you give me just a brief explanation
    about how to implement it? Many thanks in advance.


    Fred'
- created: 2007-01-30 04:32:01.734375000 -06:00
  author: Rasheed
  email: rasheed.rahman@samba.com
  content: ! 'Hi,


    I really appreciate you great help if you could kindly have a look at the below
    scenario and provide your feed back. thankyou.


    I have a web site in which, I would like to create or have a table (with add/remove
    option)in each/every profile, &amp; one column of that table should be dropdown
    (where he should be able to select the server name)&amp; rest of the columns he
    can able to write/fill.


    please do kinldy help me. Thanks again,'
- created: 2007-02-21 23:08:03.680375000 -06:00
  author: velu
  email: velumca@gmail.com
  content: ! "hai\n\n\n i am doing project in asp dot net. i had a doubt that is how
    to set they dropdownlist size when you add more items\n\ni was add 100 items if
    i click the dropdownlist the size is increase. i want display 10 items, other
    items view through scrollbar\n\nreply me"
- created: 2007-03-28 13:04:53.593750000 -05:00
  author: Emilio
  email: me@notspam.com
  url: http://www.FocusOnPanama.com/
  content: ! 'Downloaded this, the binary version works well only the formatting does
    not allow for freedom and I needed to have some profile properties disabled so
    that I could use a drop down instead.


    Anyway, I was trying to play with the source code but it does not open with VS.2003
    and also not with C# Express 2005'
- created: 2007-03-28 21:41:35.828125000 -05:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: ! 'Profiles were not available in .NET 1.1, so Visual Studio 2003 will
    not work.

    C# Express does not support class libraries, so it will not work either. You need
    a full version of Visual Studio 2005. You could probably also use MSBuild.exe,
    CSC.exe, or SharpDevelop to compile the code.'
- created: 2007-04-14 08:42:29.234375000 -05:00
  author: Emilio
  email: degt@hotmail.com
  url: http://www.focusonpanama.com/
  content: ! 'Actually I got it to compile in Express C# 2005 just fine. Altered the
    source to add a property so that one can select rendering type (DIV/Table) although
    DIV seems to be the best.


    The problem I found using it in an admin page is that when you change the name
    of the user nothing happens. Further investigation revealed that when the Username
    property of the control is set it only updates the private member field but it
    does not bother to update the controls with the values of the properties of the
    selected user :O


    Haven''t yet figured out how to get it done without breaking the rest.'
- created: 2007-08-05 14:01:31.629750000 -05:00
  author: Stephen Gutknecht
  email: Stephen@IPCoast.com
  content: ! 'RE: Has anyone figured out how to retrieve profile data without updating
    the LastActivityDate? This has been a big headache for me and is keeping me from
    using profiles to store data.



    When you call GetProfile, there is a second param (bool) you can set that will
    force it to NOT update.'
- created: 2007-11-14 22:35:50.609500000 -06:00
  author: Johan Van Dyk
  email: vdykcj@telkom.co.za
  url: http://www.telkom.co.za
  content: ! 'Joshua


    I want to use your control but have only one isue with it and do not have enough
    knowledge to modify your source code.


    My Problem as follows:

    I have Profile Properties defined in web.config as below - :

    &lt;add name=&quot;Country&quot; type=&quot;string&quot;/&gt;

    &lt;add name=&quot;Gender&quot; type=&quot;string&quot;/&gt;

    &lt;add name=&quot;Age&quot; type=&quot;Int32&quot;/&gt;

    &lt;add name=&quot;DateOfBirth&quot; type=&quot;DateTime&quot;/&gt;


    When viewing the page containing your control thru the browser, only the COUNTRY
    and GENDER properties is available to be edited. Is there any reaon why the other
    two is not available. Might it have something to do with their TYPE?


    Thanks in advance.


    Cheers,

    Johan'
- created: 2007-11-15 18:16:14.906579400 -06:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: Johan - Try setting the types to System.Int32 and System.DateTime, respectively.
- created: 2007-11-16 10:15:11.708194000 -06:00
  author: Johan Van Dyk
  email: vdykcj@telkom.co.za
  url: http://www.telkom.co.za
  content: ! 'Hi Joshua


    Thanks for your quick response. That did the trick. Is there any easy way of setting
    the properties for the individual fields, i.e. width of textboxes, validation
    etc.


    Cheers,

    Johan'
- created: 2007-12-29 15:22:50.125000000 -06:00
  author: LTG
  email: lwhitney@yahoo.com
  url: http://www.hdgreetings.com
  content: ! 'Great control Josh - A quick question:


    It would seem very common to be able to set a &quot;display name&quot; for profile
    properties.  Is there any easy way to do this?


    For example I might have a property called SpecialOffer, and the code should use
    that name, yet the HTML display might be &quot;Free ECards&quot;.


    Otherwise the UI could not be changed independent of the code, right?


    Any feedback appreciated -

    LTG'
- created: 2008-03-15 04:33:41.895750000 -05:00
  author: shahbaz tavackoli
  email: stavackoli@gmail.com
  content: how can i get profile for defined username by your control?
- created: 2008-03-30 05:50:26.267625000 -05:00
  author: jack
  content: ! 'hi


    i downloaded the .zip file.


    But i could not find .aspx file on it.


    how do i make this application run?


    thanks.'
- created: 2008-03-30 09:21:12.814500000 -05:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: Jack - ProfileView is not an application, it is just a WebControl that
    you can use in your own application.
- created: 2008-04-14 11:21:23.665500000 -05:00
  author: Naomi
  content: ! "I was struggling with the problem of updating last activity date for
    quite a time. I'm really lucky of finding this blog after lots of digging in code
    and various blogs on the web.\n\nSo, what is the final solution to avoid updates
    of the last activity date? My code looks like this:\n\nprivate MembershipUserCollection
    GetSiteUsers()\n\t{\n\t\tMembershipUserCollection siteMembers = new MembershipUserCollection();\n\t\tMembershipUserCollection
    Members = Membership.GetAllUsers();\n\t\t\n\t\tforeach (MembershipUser CurrUser
    in Members)\n\t\t{\n\t\t\tif (Profile.GetProfile(CurrUser.UserName).SiteID ==
    Profile.SiteID &amp;&amp;\n\t\t\t\t!Roles.IsUserInRole(CurrUser.UserName, &quot;MasterAdmin&quot;))\n\t\t\t{\n\t\t\t\tsiteMembers.Add(CurrUser);\n\t\t\t}\n\t\t}\n\t\treturn
    siteMembers;\n\t}"
- created: 2008-04-14 18:55:46.384250000 -05:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: Naomi - I'm not sure what you mean by &quot;final solution&quot;. I proposed
    two possible solutions in the comments above. You will need to decide which is
    the best for your situation.
- created: 2008-04-17 12:35:52.915500000 -05:00
  author: Naomi
  content: I don't see the second parameter in GetProfile method
- created: 2008-05-07 17:10:57.560498800 -05:00
  author: ben
  content: How about a screenshot of it in a working environment, so we can quickly
    see if this is something we would like to implement... or not. Gracias!
- created: 2008-07-15 11:38:07.882125000 -05:00
  author: Sam
  email: stucker@asicentral.com
  content: ! 'Is this compatible with the table profile provider?  Anyone tried it?

    (http://www.asp.net/downloads/sandbox/table-profile-provider-samples/)'
- created: 2008-07-15 17:12:14.835250000 -05:00
  author: Joshua Flanagan
  email: josh@flimflan.com
  url: http://flimflan.com/blog
  content: Sam, the ProfileView control is built on top of the exposed Profile API,
    so it should work regardless of the provider implementation you are using.
- created: 2008-08-19 12:39:41.304625000 -05:00
  author: Brian Graffius
  email: egraffius@mindspring.com
  url: http://www.graffiusinnovation.com
  content: ! "Hi Josh, \n\nthis control was very helpful.  I have one issue, once
    the form is working and a user fills it out, how do you get it to move to a new
    page.  Is there a way to make this another step in the create account wizard?"
- created: 2008-09-02 17:06:37.656125000 -05:00
  author: Doug
  content: ! 'This control looks like exactly what I need.  I''m having some trouble
    getting the control to load a different user''s profile, however, even though
    it looks like you''ve added that functionality from the update log.  I set {control}.username
    = &quot;MUser&quot; and call to {control}.databind but it still shows the currently
    logged in user.  Am I missing something simple?


    Thanks,


    Doug'

---

<div>
<h1>ProfileView</h1>
<p>This is the official home of my new <strong>ProfileView</strong> control. ProfileView is an ASP.NET 2.0 server control that enables your users to view and/or edit their Personalization Profile. Read my <a href="/IntroducingProfileViewForASPNET20.html">original post</a> about it for more background.</p>
<h2>Download</h2>
<p>The source code is now freely available! Download it and do with it as you wish. If you add any features, I would appreciate it if let me know about it using the contact information on <a href="/">my blog</a>.</p>
<p><a href="/assets/downloads/FlimFlan_WebControls.zip">Download the binary</a></p>
<p><a href="/assets/downloads/FlimFlan_WebControls_Source.zip">Download the source code</a></p>
<h2>How to use</h2>
<p>Register the assembly at the top of the aspx page that will host the control: <br /> </p>
<div style="background: white none repeat scroll 0% 50%; font-family: Consolas; font-size: 10pt; color: darkblue; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<p style="margin: 0px;">&lt;%@ Register Assembly=<span style="color: maroon;">&quot;FlimFlan.WebControls&quot;</span> Namespace=<span style="color: maroon;">&quot;FlimFlan.WebControls&quot;</span> TagPrefix=<span style="color: maroon;">&quot;flim&quot;</span> %&gt;</p>
</div>
<p>Place the control markup where you want the ProfileView to appear: <br /> </p>
<div style="background: white none repeat scroll 0% 50%; font-family: Consolas; font-size: 10pt; color: darkblue; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
<p style="margin: 0px;">&lt;flim:<span style="color: teal;">ProfileView</span> ID=<span style="color: maroon;">&quot;UserProfile&quot;</span> runat=<span style="color: maroon;">&quot;server&quot;</span> /&gt;</p>
</div>
<h2>History</h2>
<p>June 24, 2006: Release 1.2.524.2006</p>
<ul>
    <li>Added the UserName property to allow you to edit the profile of any user in the system - not just the current user.<br /></li>
</ul>
<p>January 8, 2006: Release 1.1.108.2006</p>
<ul>
    <li>Properties now display in the order they are listed in web.config<br /></li>
    <li>Design-time view now uses same rendering method as runtime</li>
    <li>Fixed design-time bug that caused it to fail when a profile property type was not specified</li>
    <li>Design-time view now has a Smart Tag to allow you to preview an anonymous user's profile<br /></li>
</ul>
<p>October 30, 2005: Updated for the final release (RTM) version of Visual Studio 2005 / .NET Framework 2.0</p>
<p>July 7, 2004: A significantly updated version is now available.</p>
<ul>
    <li>The design-time view now shows your actual profile properties, instead of sample properties  </li>
    <li>New ReadOnly mode allows you to use ProfileView to display a user's profile, without allowing them to edit it.  </li>
    <li>Now supports profile groups</li>
</ul>
<p>TODO:</p>
<ul>
    <li>Add the ability to disable display of profile properties by their &ldquo;group&ldquo;  </li>
    <li>Create a templated UI (or at least more style/formatting properties)</li>
    <li>Allow better support for display of custom types/collections<br /></li>
</ul>
</div>
